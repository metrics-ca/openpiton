Support Ariane RV64IMAC Core
============================

Assuming all prerequisites have been completed, here is all you need to do to run the test:

      cd <top of the repository>  # which is where you currently are reading this file
      source ./setup.bash
      cd ./build
      mkplilib clean dsim

      If you would prefer to run using VPI, do these steps:

           mkplilib dsim
           sims -sys=manycore -x_tiles=2 -y_tiles=2 -clean -dsim_build -ariane
           sims -sys=manycore -x_tiles=2 -y_tiles=2 -dsim_run -ariane hello_world_many.c -rtl_timeout 10000000

      If you would prefer to run using DPI, do these steps:

           mkplilib dsim_dpi
           USE_DPI=1 sims -sys=manycore -x_tiles=2 -y_tiles=2 -clean -dsim_build -ariane -config_rtl=PITON_DPI
           USE_DPI=1 sims -sys=manycore -x_tiles=2 -y_tiles=2 -dsim_run -ariane hello_world_many.c -rtl_timeout 10000000
    

Prerequisites
=============

1. Install libbit-vector-perl library (done for eng-1 host):
   for Debian-10, it is https://packages.debian.org/buster/libbit-vector-perl

2. Build and install DSim using the openpiton_bugs_20211025 branch:

     a) find the path to install DSim to:
          echo $DV_ROOT/tools/dsim
          # clear the target path (workaround for #4718)
          rm -r $DV_ROOT/tools/dsim

     b) Switch to the working area with DSim repository to build/install DSim:
          cd superp/source/dsim
          scons debug=1 -j4 prefix=<the path found in the previous step a> install

     c) Switch back to the working area with OpenPiton repository, and load
        the installed DSim:
          module use -a $DV_ROOT/tools/Modules
          module load dsim-openpiton

3. Prepare RISC-V toolchain, and the components needed for tests:

   a) Build the RISC-V toolchain, and the components:
        export ROOT=$PITON_ROOT
        ./piton/ariane_build_tools.sh

      Note that this will take a while.  Once completed, verify the location of
      riscv64-unknown-elf-gcc:
        which riscv64-unknown-elf-gcc
      The expected location is:
        /scratch/user/$USER/tool/riscv_install/bin/riscv64-unknown-elf-gcc

   b) WARNING
        This step is needed only if the previous step (a) is unsuccessful:
          module load riscv_tools/dev

        Verify the location of riscv64-unknown-elf-gcc:
          which riscv64-unknown-elf-gcc
        The expected location is:
          /tools/riscv_tools/dev/bin/riscv64-unknown-elf-gcc
